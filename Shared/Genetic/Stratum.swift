//
//  dyerlab.org                                          @dyerlab
//                      _                 _       _
//                   __| |_   _  ___ _ __| | __ _| |__
//                  / _` | | | |/ _ \ '__| |/ _` | '_ \
//                 | (_| | |_| |  __/ |  | | (_| | |_) |
//                  \__,_|\__, |\___|_|  |_|\__,_|_.__/
//                        |_ _/
//
//         Making Population Genetic Software That Doesn't Suck
//
//  GeneticStudio
//  Locus.swift
//
//  Created by Rodney Dyer on 12/17/21.
//  Copyright (c) 2021 Rodney J Dyer.  All Rights Reserved.
//

import CoreLocation
import Foundation
import SwiftUI

public class Stratum: Codable  {
    
    /// Making it hashable
    public var id = UUID()
        
    /// The name of this particular stratum
    public var label: String
    
    /// The stratigraific level of this stratum
    public var level: String
    
    /// Is this empty of data
    public var isEmpty: Bool {
        return !isLocale && childCount == 0
    }
    
    /// Is this a sampling locale (e.g., has individuals)
    public var isLocale: Bool {
        return _individuals.count > 0
    }
    
    /// Number of children at next level
    public var childCount: Int {
        return substrata.count
    }
    
    /// Sublevel Labels
    public var childLevel: String {
        return self.substrata.first?.level ?? "No Labels"
    }
    
    /// Nested Levels
    public var nestedLevels: [String] {
        var ret = [ self.level ]
        for stratum in self.substrata {
            ret.append(contentsOf: stratum.nestedLevels )
        }
        return ret.unique()
    }
    
    /// Get all the headers for the individuals in this stratum
    public var allHeadings: [String] {
        var ret = self.nestedLevels
            
        if let ind = individuals.first {
            if let _ = ind.location {
                ret.append( "Longitude" )
                ret.append( "Latitude" )
            }
            ret.append(contentsOf: ind.loci.keys.sorted {$0.localizedStandardCompare($1) == .orderedAscending} )
        }
        return ret
    }
    
    /// Hard coding the codability
    enum CodingKeys: String, CodingKey {
        case id
        case label
        case level
        case individuals
        case substrata
    }
    
    /// All the substrata under this one.
    var substrata: [Stratum] = []
    
    /// Individuals at this level
    var _individuals: [Individual] = []
    
    /// All individuals at this level and all other levels.
    public var individuals: [Individual] {
        var ret = [Individual]()
        
        if substrata.isEmpty {
            ret = self._individuals
        } else {
            for substratum in substrata {
                ret.append(contentsOf: substratum.individuals)
            }
        }
        return ret
    }
    
    /**
     Designated initializer.
     */
    public init(label: String, level: String = "All Data" ) {
        self.label = label
        self.level = level
    }
    
    /**
     Required init for Codable
     */
    public required init(from decoder: Decoder) throws {
        let values = try decoder.container(keyedBy: CodingKeys.self )
        self.id = try values.decode( UUID.self, forKey: .id )
        self.label = try values.decode( String.self, forKey: .label )
        self.level = try values.decode( String.self, forKey: .level )
        self.substrata = try values.decode( Array.self, forKey: .substrata )
        self._individuals = try values.decode( Array.self, forKey: .individuals )
    }
    
    /**
     Required encode
     */
    public func encode(to encoder: Encoder) throws {
        var container = encoder.container(keyedBy: CodingKeys.self )
        try container.encode( self.id, forKey: .id )
        try container.encode( self.label, forKey: .label )
        try container.encode( self.level, forKey: .level )
        try container.encode( self.substrata, forKey: .substrata )
        try container.encode( self._individuals, forKey: .individuals )
    }
    
        
    /**
     Add a substratum to this one.
     - Parameters:
        - stratum: The new stratum to add.
     */
    public func addSubstratum(stratum: Stratum) {
        self.substrata.append( stratum )
    }
    
    /**
     Return a substratum by name
     - Parameters:
        - named: The label of the Stratum being sought
     - Returns: The stratum or nil
     */
    public func substratum(named: String) -> Stratum? {
        if named == self.label { return self }
        
        for child in substrata {
            if let found = child.substratum(named: named ) {
                return found
            }
        }
        return nil
    }
    
    /**
     Returns substrata with passed names
     - Parameters:
        - named: A vector of names for strata
     - Returns: A Vector of Stratum
     */
    public func substrata( named: [String] ) -> [Stratum] {
        return named.compactMap{ self.substratum(named: $0) }
    }
    
    
    /**
     Returns names of stratum for a particualr level
     - Parameters:
        - Level: The level looking for
     - Returns: An array of stratum names
     */
    public func substrataAtLevel( named: String ) -> [String] {
        var ret = [String]()
        if self.level == named {
            ret.append( self.label )
        } else {
            for child in substrata {
                ret.append(contentsOf: child.substrataAtLevel(named: named) )
            }
        }
        return ret
    }
    
    /**
     Returns substrata for a particular level
     - Parameters:
        - level: Name of the strata level
     - Returns: Array of Stratum
     */
    public func substrata( level: String ) -> [Stratum] {
        return substrata(named: self.substrataAtLevel(named: level ))
    }
    
    /**
     Get the label of the stratum that has this individual at the particular level.
     - Parameters:
        - level: Stratum level to look for
        - individual: The individual in question.
     - Returns: The ``label`` of the stratum with the indivudal
     */
    public func labelForIndividual( individual: Individual, atLevel: String) -> String? {
        if atLevel == self.level && self.individuals.contains( individual ) {
            return self.label
        }
        else {
            for child in self.substrata {
                if let label = child.labelForIndividual(individual: individual, atLevel: atLevel) {
                    return label
                }
            }
        }
        return nil
    }
    
    
    
    /**
     Just return individuals from named substrata
     - Parameters:
        - named: An array of named stratum from which to get individuals.
     - Returns: A single array of Individual objects
     */
    public func individualsFrom( named: [String] ) ->  [ Individual ] {
        var ret = [Individual]()
            
        for stratum in substrata(named: named) {
            ret.append(contentsOf: stratum.individuals )
        }
        
        return ret
    }
    
    
    /**
     Find the vector of stratum names for a given level
     */
    
    func stratumIdentifierForIndividuals( targetLevel: String ) -> [String] {
        var ret = [String]()
        if targetLevel == self.level {
            ret.append(contentsOf: Array(repeating: self.label, count: self.individuals.count))
        } else {
            for substratum in substrata {
                ret.append( contentsOf: substratum.stratumIdentifierForIndividuals(targetLevel: targetLevel) )
            }
        }
        return ret
    }
    
    
    
    /**
     Add individuals to this or some substratum.  This will automatically populate subgroups.
     - Parameters:
        - individual: The individual object class
        - stratum: A vector of strata names.
        - levels: A vector of level names.
     */
    public func addIndividual( individual: Individual, strata: [String], levels: [String] ) {

        var substrata = strata
        var sublevels = levels
        
        if substrata.count == 0 {
            self._individuals.append( individual )
        } else {
            
            let nextStratum = substrata.removeFirst()
            let nextLevel = sublevels.removeFirst()
            if let child = substratum(named: nextStratum ) {
                child.addIndividual(individual: individual, strata: substrata, levels: sublevels)
            }
            else {
                let child = Stratum(label: nextStratum, level: nextLevel)
                self.addSubstratum(stratum: child )
                child.addIndividual(individual: individual, strata: substrata, levels: sublevels)
            }
        }
    }
}

// MARK: - Loading from file

extension Stratum {
    
    /**
     Populates from data
     - Parameters:
        - data: The data object that contains the CSV text data
     */
    public func loadFromData( data: Data ) {
        guard let content = String( data: data, encoding: .utf8) else { return }
        self.loadFromCSV( raw: content)
    }
    
    
    /**
     Populate data from string values
     - Parameters:
        - data: A data object that contains CSV data.
     */
    public func loadFromCSV( raw: String  ) {
        let lines = raw.components(separatedBy: "\n").map { $0.trimmingCharacters(in: CharacterSet.newlines).components(separatedBy: ",") }
        
        if lines.count < 2 {
            return
        }
        let N = lines.count
        let K = lines[0].count
        
        let header = lines[0].map{ $0.trimmingCharacters(in: CharacterSet.whitespacesAndNewlines) }
        
        // Check for longitude or latitude
        if let idxLon = header.firstIndex(where: {$0 == "Longitude"} ),
           let idxLat = header.firstIndex(where: {$0 == "Latitude"} ) {
        
            let mn = min( idxLat, idxLon )
            let mx = max( idxLat, idxLon )
            
            var levels = [String]()
            for i in 0 ..< mn {
                levels.append( header[i] )
            }
            
            for i in 1 ..< N {
                let ind = Individual()
                
                if let lat = Double( lines[i][idxLat] ),
                   let lon = Double( lines[i][idxLon] ) {
                    ind.location = CLLocationCoordinate2D( latitude: lat,
                                                           longitude: lon )
                }
                
                var strata: [String] = []
                for s in 0 ..< mn {
                    strata.append( lines[i][s])
                }
                
                for l in mx ..< K {
                    let key = header[l]
                    ind.loci[key] = Locus(raw: lines[i][l] )
                }
                
                self.addIndividual(individual: ind, strata: strata, levels: levels)

            }
        }
    }
    
    
}


// MARK: - Custom String Convertable
extension Stratum: CustomStringConvertible {
    
    /// Overloading of the
    public var description: String {
        var ret = "\(label) {"
        if !substrata.isEmpty {
            ret += substrata.map { $0.description }.joined(separator: ", ")
        } else {
            ret += "N = \(_individuals.count) "
        }
        ret += "} "
        return ret
    }

    
   
    
    
}



extension Stratum: Hashable {
    
    public func hash(into hasher: inout Hasher) {
        hasher.combine(self.id)
    }
    
    public static func == (lhs: Stratum, rhs: Stratum) -> Bool {
        return lhs.id == rhs.id
    }
   
    
}






// MARK: - Static Stuff

extension Stratum {

    public static func DefaultStratum() -> Stratum {
        
        let stratum = Stratum(label: "All", level: "All")
        let raw = [
            [ "NBP", "88", "29.32544972", "-114.2935239", "1:1", "", "2:4", "1:2", "", "", "9:9", "7:7" ],
            [ "NBP", "88", "29.32543502", "-114.2934676", "1:1", "1:3", "1:1", "1:1", "1:1", "8:9", "9:9", "7:7" ],
            [ "NBP", "88", "29.32550936", "-114.2934508", "1:1", "1:3", "1:1", "1:1", "1:1", "8:9", "9:9", "5:7" ],
            [ "NBP", "88", "29.32545785", "-114.2934578", "1:1", "1:1", "1:2", "1:1", "1:1", "8:9", "9:9", "7:7" ],
            [ "NBP", "88", "29.32543401", "-114.2934718", "1:1", "1:3", "1:2", "1:1", "1:1", "8:9", "9:9", "5:5" ],
            [ "NBP", "88", "29.3255004", "-114.2934622", "1:1", "1:1", "1:2", "1:1", "1:1", "9:9", "9:9", "7:7" ],
            [ "NBP", "88", "29.32544338", "-114.2934972", "1:1", "1:1", "1:2", "1:1", "1:1", "7:9", "9:9", "5:7" ],
            [ "NBP", "88", "29.32541581", "-114.2935022", "1:1", "1:1", "1:2", "1:1", "1:1", "7:7", "9:9", "5:7" ],
            [ "NBP", "88", "29.32547339", "-114.2934413", "1:1", "1:3", "1:2", "1:1", "1:1", "9:10", "9:9", "7:7" ],
            [ "NBP", "88", "29.32550168", "-114.2934627", "1:1", "1:1", "1:1", "1:1", "1:2", "7:8", "9:9", "7:7" ],
            [ "NBP", "9", "29.01466667", "-113.9448528", "1:1", "1:1", "1:2", "1:1", "1:1", "6:9", "9:9", "7:7" ],
            [ "NBP", "9", "29.01465294", "-113.9448063", "1:1", "1:1", "1:2", "1:1", "1:1", "9:9", "9:9", "7:7" ],
            [ "NBP", "9", "29.01466982", "-113.944835", "1:1", "1:1", "1:2", "1:1", "1:1", "9:9", "9:9", "7:7" ],
            [ "NBP", "9", "29.0146439", "-113.9447991", "1:1", "1:1", "1:2", "1:1", "1:1", "6:6", "9:9", "7:7" ],
            [ "NBP", "9", "29.01465316", "-113.9448204", "1:1", "1:3", "1:2", "1:1", "1:1", "9:9", "7:9", "5:7" ],
            [ "NBP", "9", "29.0146601", "-113.9447925", "1:1", "1:1", "1:1", "1:1", "1:1", "9:9", "9:9", "7:7" ],
            [ "NBP", "9", "29.0146056", "-113.9448473", "1:1", "1:3", "1:1", "1:1", "1:1", "9:10", "5:9", "7:7" ],
            [ "NBP", "9", "29.01460941", "-113.9448492", "1:1", "1:1", "1:2", "1:1", "1:1", "7:9", "9:9", "7:7" ],
            [ "NBP", "9", "29.01463771", "-113.9448019", "1:1", "1:3", "1:1", "1:1", "1:1", "9:9", "9:9", "7:7" ],
            [ "NBP", "84", "28.9665785", "-113.667856", "1:1", "1:3", "1:1", "1:1", "1:1", "9:9", "9:9", "5:7" ],
            [ "NBP", "84", "28.96657545", "-113.6678313", "1:1", "1:1", "1:1", "1:1", "1:2", "8:9", "9:9", "5:15" ],
            [ "NBP", "84", "28.96655688", "-113.6678462", "1:1", "1:1", "1:2", "1:1", "1:1", "7:9", "7:9", "7:7" ],
            [ "NBP", "84", "28.96653779", "-113.6678154", "1:1", "", "1:1", "1:2", "", "", "5:9", "7:7" ],
            [ "NBP", "84", "28.9666033", "-113.6678526", "1:1", "1:1", "1:5", "1:1", "1:1", "7:7", "9:9", "7:7" ],
            [ "NBP", "84", "28.96655318", "-113.6678588", "1:1", "1:1", "1:1", "1:1", "1:1", "9:9", "9:9", "7:7" ],
            [ "NBP", "84", "28.96656164", "-113.6678471", "1:1", "1:1", "1:2", "1:1", "1:1", "7:9", "9:9", "5:5" ],
            [ "NBP", "84", "28.96659216", "-113.6678074", "1:1", "1:1", "1:2", "1:1", "1:1", "9:9", "9:9", "5:7" ],
            [ "NBP", "84", "28.96656116", "-113.6678003", "1:1", "1:3", "1:5", "1:1", "1:1", "9:9", "7:9", "7:7" ],
            [ "NBP", "175", "28.7279802", "-113.4896699", "1:1", "1:1", "1:2", "1:1", "1:2", "8:9", "9:9", "5:7" ],
            [ "NBP", "175", "28.72800503", "-113.4896908", "1:1", "1:1", "1:2", "1:1", "1:1", "9:9", "9:9", "5:7" ],
            [ "NBP", "175", "28.72796236", "-113.4896512", "1:1", "1:1", "1:1", "1:1", "2:2", "9:9", "9:9", "5:5" ],
            [ "NBP", "175", "28.72804648", "-113.4897222", "1:1", "1:3", "1:1", "1:1", "1:2", "6:9", "9:9", "7:7" ],
            [ "NBP", "175", "28.72801868", "-113.4896494", "1:1", "1:1", "1:1", "1:1", "2:2", "8:9", "9:9", "5:7" ],
            [ "NBP", "175", "28.72802016", "-113.4896623", "1:1", "1:1", "1:1", "1:1", "2:2", "8:8", "9:9", "7:7" ],
            [ "NBP", "175", "28.72799794", "-113.4897259", "1:1", "3:3", "1:2", "1:1", "2:2", "9:10", "9:9", "5:7" ],
            [ "NBP", "177", "28.66061425", "-113.991372", "1:1", "1:3", "1:1", "1:1", "2:2", "7:7", "9:9", "5:7" ],
            [ "NBP", "177", "28.66061276", "-113.9913235", "1:1", "1:1", "1:1", "1:1", "2:2", "6:9", "9:9", "5:7" ],
            [ "NBP", "177", "28.66057224", "-113.9913607", "1:1", "1:3", "1:1", "1:1", "2:2", "7:9", "9:9", "7:7" ],
            [ "NBP", "177", "28.66065806", "-113.9913463", "1:1", "1:3", "1:1", "1:1", "1:2", "6:8", "9:9", "7:7" ],
            [ "NBP", "177", "28.66056024", "-113.9913787", "1:1", "1:1", "1:1", "1:1", "2:2", "8:9", "9:9", "7:7" ],
            [ "NBP", "177", "28.66064819", "-113.9913277", "1:1", "1:3", "1:1", "1:1", "1:1", "9:10", "9:9", "7:7" ],
            [ "NBP", "177", "28.66059254", "-113.9913268", "1:1", "1:3", "1:2", "1:1", "1:1", "9:9", "9:9", "7:7" ],
            [ "NBP", "177", "28.66060869", "-113.9913266", "1:1", "1:1", "1:2", "1:1", "1:2", "6:9", "9:9", "7:7" ],
            [ "NBP", "177", "28.66057375", "-113.991359", "1:1", "1:1", "1:2", "1:1", "1:1", "9:9", "9:9", "5:5" ],
            [ "NBP", "177", "28.66059263", "-113.9913223", "1:1", "1:1", "1:2", "1:1", "1:1", "7:9", "9:9", "5:8" ],
            [ "NBP", "173", "28.40849679", "-112.8698235", "1:1", "3:3", "1:1", "1:1", "2:2", "8:8", "7:10", "7:7" ],
            [ "NBP", "173", "28.40847731", "-112.8697881", "1:1", "3:3", "1:1", "1:1", "2:2", "9:9", "9:9", "7:7" ],
            [ "NBP", "173", "28.40852204", "-112.86978", "1:1", "3:3", "1:1", "1:1", "2:2", "7:8", "9:9", "5:7" ],
            [ "NBP", "173", "28.40853702", "-112.8697808", "1:2", "3:3", "1:1", "1:1", "1:2", "7:9", "9:9", "5:5" ],
            [ "NBP", "173", "28.40850134", "-112.8698413", "1:1", "3:3", "1:1", "1:1", "1:1", "7:8", "9:9", "6:7" ],
            [ "NBP", "173", "28.40850511", "-112.8697681", "1:1", "3:3", "1:1", "1:1", "2:2", "7:7", "7:9", "5:7" ],
            [ "NBP", "173", "28.40848144", "-112.869846", "1:2", "3:3", "1:3", "1:1", "1:1", "7:7", "7:9", "5:7" ],
            [ "NBP", "173", "28.40850153", "-112.8698053", "1:1", "1:3", "1:1", "1:1", "2:2", "8:8", "9:9", "5:7" ],
            [ "NBP", "173", "28.4084632", "-112.8697764", "1:1", "3:3", "1:3", "1:1", "1:2", "8:9", "9:9", "4:7" ],
            [ "NBP", "173", "28.4085505", "-112.8698066", "1:1", "1:3", "1:1", "1:1", "2:2", "8:8", "9:9", "6:7" ],
            [ "NBP", "171", "28.22314522", "-113.1826154", "1:1", "3:3", "1:1", "1:1", "", "8:9", "9:9", "5:6" ],
            [ "NBP", "171", "28.22309899", "-113.1826065", "1:1", "1:1", "1:2", "1:1", "2:2", "7:9", "7:9", "5:5" ],
            [ "NBP", "171", "28.22309388", "-113.1825662", "1:1", "1:3", "1:1", "1:1", "2:2", "8:8", "9:9", "5:7" ],
            [ "NBP", "171", "28.22314705", "-113.1825414", "1:1", "1:1", "1:1", "1:1", "2:2", "7:7", "9:9", "5:5" ],
            [ "NBP", "171", "28.22313542", "-113.1825946", "1:1", "1:3", "1:1", "1:1", "2:2", "9:9", "9:9", "7:7" ],
            [ "NBP", "171", "28.22313322", "-113.1825898", "1:1", "1:3", "3:3", "1:1", "2:2", "8:8", "9:9", "5:5" ],
            [ "NBP", "171", "28.22310095", "-113.1825515", "1:2", "3:3", "1:1", "1:1", "1:2", "7:8", "9:9", "7:7" ],
            [ "NBP", "171", "28.22317403", "-113.1826219", "1:2", "1:3", "1:1", "1:1", "2:2", "8:8", "7:9", "7:7" ],
            [ "NBP", "171", "28.22309225", "-113.182595", "1:1", "1:3", "1:1", "1:1", "1:2", "8:9", "9:9", "7:7" ],
            [ "NBP", "171", "28.22312003", "-113.1826118", "1:1", "1:3", "1:1", "1:1", "2:2", "8:8", "9:9", "5:7" ],
            [ "NBP", "89", "28.03669646", "-113.399842", "1:1", "3:3", "1:3", "1:1", "2:2", "7:9", "9:10", "5:7" ],
            [ "NBP", "89", "28.03665846", "-113.3998233", "1:1", "3:3", "1:1", "1:1", "2:2", "9:9", "9:10", "5:7" ],
            [ "NBP", "89", "28.03661297", "-113.3998516", "1:1", "3:3", "3:3", "1:1", "2:2", "8:9", "7:9", "7:8" ],
            [ "NBP", "89", "28.03670479", "-113.3998355", "1:2", "3:3", "1:1", "1:1", "", "7:10", "9:9", "7:7" ],
            [ "NBP", "89", "28.0366264", "-113.3998323", "1:1", "3:3", "3:5", "1:1", "2:2", "7:8", "7:9", "5:7" ],
            [ "NBP", "89", "28.03664377", "-113.3998608", "1:1", "3:3", "1:1", "1:1", "2:2", "8:9", "7:7", "5:7" ],
            [ "NBP", "89", "28.03670981", "-113.3998259", "1:2", "3:3", "1:1", "1:1", "2:2", "7:9", "7:9", "5:7" ],
            [ "NBP", "89", "28.03666173", "-113.3998725", "1:1", "3:3", "1:1", "1:1", "2:2", "7:9", "9:9", "5:7" ],
            [ "NBP", "89", "28.03662187", "-113.3998938", "1:1", "3:3", "1:1", "1:1", "2:2", "7:7", "7:9", "5:7" ],
            [ "NBP", "89", "28.03663194", "-113.3998961", "1:1", "1:3", "1:1", "1:1", "2:2", "7:7", "9:9", "7:7" ],
            [ "NBP", "159", "27.52944602", "-113.3160009", "1:1", "1:3", "1:3", "1:1", "2:2", "8:9", "9:9", "5:7" ],
            [ "NBP", "159", "27.52948771", "-113.3160842", "1:1", "1:3", "2:5", "1:1", "2:2", "7:8", "9:9", "4:7" ],
            [ "NBP", "159", "27.52953925", "-113.3160865", "1:1", "1:3", "1:1", "1:1", "2:2", "7:8", "7:9", "5:7" ],
            [ "NBP", "159", "27.52952378", "-113.3160426", "1:1", "1:3", "1:1", "1:1", "2:2", "8:11", "7:9", "5:7" ],
            [ "NBP", "159", "27.52947829", "-113.3160462", "1:2", "1:3", "1:1", "1:1", "2:2", "8:8", "9:9", "4:7" ],
            [ "NBP", "159", "27.52953567", "-113.3160722", "1:2", "3:3", "1:1", "1:1", "2:2", "7:8", "9:9", "5:7" ],
            [ "NBP", "159", "27.52953386", "-113.3160413", "1:1", "3:3", "1:1", "1:2", "2:2", "8:9", "9:9", "5:7" ],
            [ "NBP", "159", "27.529535", "-113.3160481", "1:1", "3:3", "1:1", "1:1", "2:2", "8:9", "9:9", "5:7" ],
            [ "NBP", "159", "27.52952408", "-113.3160463", "1:1", "3:3", "3:3", "1:1", "2:2", "8:8", "7:9", "5:7" ],
            [ "NBP", "SFr", "27.36327179", "-112.9639612", "1:1", "3:3", "1:1", "1:2", "2:2", "7:7", "5:5", "5:7" ],
            [ "NBP", "SFr", "27.36323988", "-112.9639818", "1:1", "3:3", "1:1", "2:2", "2:2", "6:8", "5:5", "5:7" ],
            [ "NBP", "SFr", "27.36329436", "-112.9639979", "1:2", "3:3", "1:1", "1:2", "2:2", "8:9", "5:5", "7:7" ],
            [ "NBP", "SFr", "27.36322327", "-112.9639535", "1:1", "3:3", "1:1", "1:2", "1:2", "7:8", "5:5", "6:7" ],
            [ "NBP", "SFr", "27.3632241", "-112.9639039", "1:2", "3:3", "1:1", "1:2", "2:2", "7:7", "5:5", "5:5" ],
            [ "NBP", "SFr", "27.36324766", "-112.9639188", "2:2", "3:3", "1:1", "2:2", "2:2", "6:7", "5:5", "7:7" ],
            [ "NBP", "SFr", "27.36327494", "-112.963959", "1:1", "1:3", "1:1", "1:2", "2:2", "9:9", "5:5", "5:7" ],
            [ "NBP", "SFr", "27.36321486", "-112.963901", "1:1", "1:3", "1:1", "1:2", "2:2", "8:8", "5:5", "7:8" ],
            [ "NBP", "SFr", "27.3632603", "-112.9639897", "1:1", "3:3", "1:1", "2:2", "2:2", "7:7", "5:5", "7:7" ],
            [ "CBP", "160", "27.40499892", "-112.5295285", "1:1", "3:3", "1:1", "2:2", "1:1", "8:8", "5:5", "6:7" ],
            [ "CBP", "160", "27.40498918", "-112.5295625", "1:1", "3:3", "1:1", "2:2", "2:2", "7:9", "5:7", "5:6" ],
            [ "CBP", "160", "27.40498154", "-112.5295599", "1:2", "3:3", "1:1", "2:2", "2:2", "9:9", "5:5", "5:5" ],
            [ "CBP", "160", "27.40506774", "-112.5295139", "1:1", "3:3", "1:1", "1:1", "2:2", "9:9", "5:5", "5:7" ],
            [ "CBP", "160", "27.40499018", "-112.5295076", "1:1", "1:3", "1:1", "2:2", "2:2", "2:9", "5:5", "4:8" ],
            [ "CBP", "160", "27.4050243", "-112.5295671", "1:2", "3:3", "1:1", "2:2", "2:2", "7:7", "5:5", "5:5" ],
            [ "CBP", "160", "27.40505765", "-112.5295529", "1:1", "1:4", "1:1", "1:1", "2:2", "8:8", "5:5", "5:6" ],
            [ "CBP", "160", "27.40503939", "-112.5295449", "2:2", "3:3", "1:1", "2:2", "1:2", "7:8", "5:5", "7:8" ],
            [ "CBP", "160", "27.40501527", "-112.5295269", "1:1", "1:1", "1:1", "1:1", "2:2", "6:7", "5:5", "5:5" ],
            [ "CBP", "160", "27.40503581", "-112.5295186", "1:1", "3:3", "1:1", "1:2", "1:1", "7:8", "5:5", "7:7" ],
            [ "CBP", "162", "27.20289931", "-112.4079908", "1:1", "1:1", "1:1", "1:1", "", "7:7", "5:5", "6:6" ],
            [ "CBP", "162", "27.20282643", "-112.407951", "1:1", "1:3", "1:1", "1:1", "2:2", "7:13", "5:5", "5:5" ],
            [ "CBP", "162", "27.20284874", "-112.4079836", "1:1", "3:3", "1:1", "1:2", "2:2", "8:8", "5:5", "7:7" ],
            [ "CBP", "162", "27.20281379", "-112.4079205", "1:2", "1:1", "1:1", "2:2", "", "7:8", "5:5", "6:6" ],
            [ "CBP", "162", "27.20288945", "-112.4079792", "1:1", "3:3", "1:3", "2:2", "2:2", "7:8", "5:5", "5:7" ],
            [ "CBP", "162", "27.20281008", "-112.4079176", "1:1", "1:3", "1:1", "1:1", "2:2", "8:8", "5:5", "6:8" ],
            [ "CBP", "162", "27.20288403", "-112.4079015", "1:1", "1:3", "1:1", "1:2", "", "7:7", "5:7", "5:6" ],
            [ "CBP", "162", "27.20289908", "-112.4079655", "1:1", "3:3", "1:1", "2:2", "1:2", "8:8", "5:5", "5:7" ],
            [ "CBP", "162", "27.20280505", "-112.4079284", "1:1", "1:1", "1:1", "2:2", "2:2", "7:7", "5:5", "5:7" ],
            [ "CBP", "162", "27.20288324", "-112.407969", "1:1", "1:3", "1:1", "1:1", "2:2", "5:7", "5:5", "5:6" ],
            [ "CBP", "12", "27.18236223", "-112.6654335", "1:1", "1:3", "1:1", "1:1", "1:2", "8:10", "5:5", "5:5" ],
            [ "CBP", "12", "27.18232474", "-112.6654608", "1:2", "1:3", "1:1", "2:2", "2:2", "7:7", "5:5", "5:7" ],
            [ "CBP", "12", "27.18240898", "-112.6654503", "1:1", "1:3", "1:1", "2:2", "2:2", "7:8", "5:5", "5:8" ],
            [ "CBP", "12", "27.18241597", "-112.6654249", "1:1", "3:3", "1:1", "2:2", "1:2", "8:8", "5:5", "4:6" ],
            [ "CBP", "12", "27.18236062", "-112.6654319", "1:2", "3:3", "1:1", "2:2", "1:2", "8:8", "5:5", "5:7" ],
            [ "CBP", "12", "27.18239182", "-112.6654233", "1:1", "1:3", "1:1", "2:2", "2:2", "8:8", "5:5", "7:7" ],
            [ "CBP", "12", "27.18234473", "-112.6654869", "1:2", "1:3", "1:1", "1:1", "2:2", "6:7", "5:5", "5:5" ],
            [ "CBP", "12", "27.18240783", "-112.6655179", "1:1", "3:3", "1:1", "1:1", "1:2", "1:7", "5:5", "7:8" ],
            [ "CBP", "12", "27.18235351", "-112.6654729", "1:2", "1:3", "1:1", "1:1", "2:2", "7:7", "5:5", "5:6" ],
            [ "CBP", "12", "27.18235798", "-112.6654696", "1:1", "3:3", "1:1", "1:2", "2:2", "8:8", "5:5", "5:5" ],
            [ "CBP", "161", "27.03674872", "-112.9859678", "1:1", "3:3", "1:1", "1:2", "2:2", "7:9", "5:5", "5:7" ],
            [ "CBP", "161", "27.03670494", "-112.9859484", "1:1", "1:3", "1:1", "1:2", "2:2", "8:9", "5:5", "4:6" ],
            [ "CBP", "161", "27.03671238", "-112.9859319", "1:1", "3:3", "1:1", "1:2", "2:2", "7:8", "5:5", "6:7" ],
            [ "CBP", "161", "27.03672236", "-112.9859206", "1:1", "3:3", "1:1", "1:2", "", "7:8", "5:5", "5:6" ],
            [ "CBP", "161", "27.03675187", "-112.9859923", "1:1", "1:3", "1:1", "2:2", "2:2", "8:8", "5:5", "5:8" ],
            [ "CBP", "161", "27.03677978", "-112.985941", "1:1", "1:3", "1:1", "1:2", "2:2", "8:8", "5:5", "5:6" ],
            [ "CBP", "161", "27.03677685", "-112.9859284", "1:1", "1:3", "1:1", "1:2", "2:2", "7:9", "5:5", "6:8" ],
            [ "CBP", "161", "27.03673103", "-112.9859378", "1:2", "1:3", "1:1", "2:2", "2:2", "7:8", "5:5", "7:7" ],
            [ "CBP", "161", "27.03671991", "-112.985924", "1:1", "3:4", "1:1", "2:2", "2:2", "8:10", "5:5", "5:8" ],
            [ "CBP", "161", "27.03673794", "-112.9859061", "1:1", "1:1", "1:1", "1:2", "2:2", "7:8", "5:5", "5:7" ],
            [ "CBP", "93", "26.94593401", "-112.0460452", "1:2", "3:3", "1:1", "1:1", "2:2", "7:7", "5:5", "7:8" ],
            [ "CBP", "93", "26.94593321", "-112.0460302", "1:2", "3:3", "1:1", "1:1", "1:2", "6:9", "5:5", "5:6" ],
            [ "CBP", "93", "26.94591004", "-112.0460513", "1:1", "3:3", "1:1", "1:2", "2:2", "7:9", "5:5", "5:7" ],
            [ "CBP", "93", "26.94595741", "-112.0461122", "1:2", "3:3", "1:1", "2:2", "2:2", "7:8", "5:5", "6:6" ],
            [ "CBP", "93", "26.94591917", "-112.0460385", "1:1", "1:3", "1:1", "1:2", "2:2", "8:8", "5:5", "6:7" ],
            [ "CBP", "93", "26.94592073", "-112.0461083", "1:2", "3:3", "1:1", "1:2", "2:2", "7:8", "5:5", "5:7" ],
            [ "CBP", "93", "26.94593069", "-112.0460896", "1:1", "3:3", "1:1", "1:2", "2:2", "8:8", "5:5", "5:5" ],
            [ "CBP", "93", "26.9459132", "-112.0460998", "1:1", "1:1", "1:1", "2:2", "1:2", "8:8", "5:5", "5:5" ],
            [ "CBP", "93", "26.94597822", "-112.0460414", "1:2", "3:3", "1:1", "1:1", "", "8:9", "5:5", "7:7" ],
            [ "CBP", "93", "26.94596051", "-112.0460328", "1:2", "1:1", "1:1", "2:2", "", "8:8", "5:5", "5:5" ],
            [ "CBP", "165", "26.24908043", "-112.4094043", "1:1", "3:3", "1:1", "1:2", "2:2", "8:8", "5:5", "6:6" ],
            [ "CBP", "165", "26.24909313", "-112.4094518", "1:2", "1:3", "1:1", "1:1", "1:2", "7:10", "5:5", "7:7" ],
            [ "CBP", "165", "26.24910913", "-112.4094333", "1:1", "1:1", "1:4", "2:2", "2:2", "7:8", "5:5", "5:7" ],
            [ "CBP", "165", "26.24908305", "-112.4094496", "1:1", "1:4", "1:4", "2:2", "1:1", "7:8", "5:5", "6:7" ],
            [ "CBP", "165", "26.24911249", "-112.4094569", "1:2", "1:1", "1:1", "1:1", "2:2", "7:8", "5:5", "5:7" ],
            [ "CBP", "165", "26.24906889", "-112.4094132", "1:2", "1:1", "1:1", "2:2", "1:2", "7:7", "5:5", "5:6" ],
            [ "CBP", "165", "26.24912782", "-112.4094497", "2:2", "1:4", "1:1", "2:2", "2:2", "8:8", "5:5", "5:8" ],
            [ "CBP", "165", "26.24911858", "-112.4094446", "1:2", "3:4", "1:1", "1:2", "2:2", "7:10", "5:5", "5:5" ],
            [ "CBP", "165", "26.24912201", "-112.4093856", "1:1", "1:3", "1:1", "2:2", "1:2", "8:8", "5:5", "5:6" ],
            [ "CBP", "165", "26.24905059", "-112.4093949", "1:1", "3:3", "1:1", "2:2", "2:2", "7:9", "5:5", "5:6" ],
            [ "CBP", "169", "26.20883264", "-111.3783206", "1:1", "1:4", "1:1", "2:2", "2:2", "7:7", "5:5", "5:5" ],
            [ "CBP", "169", "26.20882722", "-111.3782842", "1:2", "3:3", "1:1", "1:2", "1:2", "7:7", "5:5", "5:5" ],
            [ "CBP", "169", "26.20883459", "-111.3782343", "1:2", "3:3", "1:1", "2:2", "2:2", "7:8", "5:5", "5:7" ],
            [ "CBP", "169", "26.2087727", "-111.3783025", "1:1", "3:4", "1:1", "2:2", "1:2", "7:8", "5:5", "5:6" ],
            [ "CBP", "169", "26.20882065", "-111.378243", "1:1", "1:3", "1:1", "1:2", "2:2", "7:9", "5:5", "5:5" ],
            [ "CBP", "169", "26.20879904", "-111.3783176", "1:2", "3:4", "1:1", "1:1", "1:2", "8:8", "5:5", "5:7" ],
            [ "CBP", "169", "26.20883684", "-111.3783159", "1:1", "3:3", "1:1", "1:2", "1:2", "8:9", "5:5", "5:7" ],
            [ "CBP", "169", "26.20878479", "-111.3782813", "1:2", "1:3", "1:1", "1:2", "1:2", "7:7", "5:5", "7:7" ],
            [ "CBP", "169", "26.20883878", "-111.3782559", "1:2", "1:3", "1:1", "1:2", "2:2", "7:8", "5:5", "5:8" ],
            [ "CBP", "169", "26.20880602", "-111.3782478", "2:2", "1:1", "1:1", "2:2", "2:2", "8:9", "5:5", "5:7" ],
            [ "CBP", "58", "26.01553212", "-111.3546801", "2:2", "3:3", "1:1", "2:2", "2:2", "7:7", "5:5", "5:7" ],
            [ "CBP", "58", "26.01555121", "-111.3547158", "2:2", "1:3", "1:1", "2:2", "1:2", "9:9", "5:5", "5:7" ],
            [ "CBP", "58", "26.0155837", "-111.3546822", "1:2", "1:3", "1:1", "2:2", "1:2", "8:8", "5:5", "5:5" ],
            [ "CBP", "58", "26.01551898", "-111.3547181", "1:2", "3:3", "1:1", "2:2", "2:2", "7:7", "5:5", "5:7" ],
            [ "CBP", "58", "26.01557822", "-111.3546522", "1:2", "3:3", "1:1", "2:2", "1:2", "8:8", "5:5", "5:7" ],
            [ "CBP", "58", "26.01555047", "-111.354739", "2:2", "1:1", "1:1", "2:2", "1:2", "8:9", "5:5", "5:5" ],
            [ "CBP", "58", "26.01554489", "-111.3547252", "2:2", "3:3", "1:1", "2:2", "2:2", "7:7", "5:5", "5:8" ],
            [ "CBP", "58", "26.01550921", "-111.3547013", "1:2", "3:3", "1:1", "2:2", "2:2", "7:7", "5:5", "5:5" ],
            [ "CBP", "58", "26.01551744", "-111.3546909", "2:2", "3:3", "1:1", "2:2", "2:2", "7:8", "5:5", "5:7" ],
            [ "CBP", "166", "25.91414754", "-112.080572", "2:2", "1:3", "1:1", "1:1", "2:2", "7:9", "5:5", "5:5" ],
            [ "CBP", "166", "25.91412764", "-112.0805409", "1:1", "2:2", "1:2", "1:1", "2:2", "3:4", "3:3", "18:18" ],
            [ "CBP", "166", "25.91414768", "-112.080603", "1:1", "3:3", "1:1", "2:2", "2:2", "5:9", "5:5", "5:8" ],
            [ "CBP", "166", "25.91415412", "-112.0805364", "1:1", "1:3", "1:1", "2:2", "2:2", "7:8", "5:5", "6:6" ],
            [ "CBP", "166", "25.9140997", "-112.0805527", "1:1", "1:3", "1:1", "2:2", "1:1", "8:8", "5:5", "5:5" ],
            [ "CBP", "166", "25.91410468", "-112.0805978", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "CBP", "166", "25.91410206", "-112.0805555", "1:2", "3:3", "1:1", "2:2", "2:2", "7:8", "5:5", "5:8" ],
            [ "CBP", "166", "25.91418003", "-112.0806133", "1:2", "3:3", "1:1", "2:2", "2:2", "7:8", "5:5", "5:7" ],
            [ "CBP", "166", "25.91411036", "-112.0805253", "1:1", "3:3", "1:1", "2:2", "2:2", "5:5", "5:5", "5:7" ],
            [ "CBP", "166", "25.91418825", "-112.0805715", "1:1", "3:3", "1:1", "2:2", "1:2", "7:7", "5:5", "5:5" ],
            [ "CBP", "64", "25.60529622", "-111.3263089", "1:2", "3:3", "1:1", "2:2", "1:2", "7:7", "5:5", "7:7" ],
            [ "CBP", "64", "25.60525353", "-111.3262814", "1:1", "1:3", "1:1", "2:2", "1:2", "7:7", "5:5", "7:7" ],
            [ "CBP", "64", "25.60522431", "-111.3262978", "1:1", "1:3", "1:1", "2:2", "1:1", "6:6", "5:5", "7:7" ],
            [ "CBP", "64", "25.60529824", "-111.3263078", "1:1", "1:3", "1:1", "2:2", "1:2", "6:8", "5:5", "7:7" ],
            [ "CBP", "64", "25.60524594", "-111.3263579", "2:2", "1:3", "1:1", "2:2", "1:1", "7:7", "5:5", "7:7" ],
            [ "CBP", "168", "25.55757504", "-111.2155537", "1:1", "3:3", "1:1", "2:2", "1:1", "7:8", "5:5", "5:7" ],
            [ "CBP", "168", "25.55763237", "-111.2156076", "1:1", "1:3", "1:1", "2:2", "1:1", "7:9", "5:5", "6:7" ],
            [ "CBP", "168", "25.55759588", "-111.2155938", "1:2", "3:3", "1:4", "2:2", "1:1", "7:7", "5:5", "6:6" ],
            [ "CBP", "168", "25.55758952", "-111.215615", "1:2", "3:3", "1:4", "2:2", "1:2", "7:8", "5:5", "7:7" ],
            [ "CBP", "168", "25.5576384", "-111.2155742", "1:2", "3:3", "1:1", "2:2", "1:2", "7:9", "5:5", "6:7" ],
            [ "CBP", "168", "25.55761391", "-111.2155714", "1:1", "3:3", "1:1", "2:2", "1:1", "8:8", "5:5", "5:6" ],
            [ "CBP", "168", "25.55765765", "-111.2155621", "1:1", "3:4", "1:1", "2:2", "1:1", "8:8", "5:5", "5:7" ],
            [ "CBP", "168", "25.55759295", "-111.215541", "1:1", "3:4", "1:1", "2:2", "1:2", "7:9", "5:5", "7:7" ],
            [ "CBP", "168", "25.55757534", "-111.215605", "1:2", "1:3", "1:1", "2:2", "2:2", "8:8", "5:5", "5:5" ],
            [ "CBP", "168", "25.55759172", "-111.2155632", "1:2", "1:3", "1:1", "2:2", "1:2", "7:7", "5:5", "6:6" ],
            [ "CBP", "51", "25.34819945", "-111.6004748", "2:2", "3:5", "1:1", "2:2", "1:2", "8:8", "5:5", "5:5" ],
            [ "CBP", "51", "25.34824521", "-111.6005021", "2:2", "3:5", "1:1", "2:2", "2:2", "6:7", "5:5", "5:7" ],
            [ "CBP", "51", "25.34826849", "-111.6005447", "2:2", "3:4", "1:1", "2:2", "1:2", "8:8", "5:5", "5:6" ],
            [ "CBP", "51", "25.34822507", "-111.6005122", "1:2", "3:3", "1:1", "2:2", "1:2", "7:8", "5:5", "5:5" ],
            [ "CBP", "51", "25.34824711", "-111.6005427", "2:2", "3:3", "1:1", "2:2", "1:2", "7:7", "5:5", "5:5" ],
            [ "CBP", "51", "25.34825141", "-111.6004939", "1:2", "3:3", "1:1", "2:2", "1:2", "8:8", "5:5", "5:7" ],
            [ "CBP", "51", "25.3482075", "-111.6005545", "2:2", "3:3", "1:1", "2:2", "1:2", "8:8", "5:5", "5:5" ],
            [ "CBP", "Const", "25.02470424", "-111.6749783", "1:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "CBP", "Const", "25.02476622", "-111.6749126", "2:2", "2:2", "1:1", "1:1", "2:2", "3:3", "3:3", "19:19" ],
            [ "CBP", "Const", "25.02475885", "-111.6749206", "2:2", "2:2", "1:1", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "CBP", "Const", "25.02476209", "-111.6749807", "2:2", "1:1", "1:1", "1:1", "1:2", "8:8", "5:5", "5:7" ],
            [ "CBP", "Const", "25.02479251", "-111.6749383", "1:2", "1:1", "1:1", "1:2", "", "", "9:9", "18:18" ],
            [ "CBP", "Const", "25.02477145", "-111.6749024", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:19" ],
            [ "CBP", "Const", "25.02477437", "-111.6749546", "2:2", "2:2", "1:2", "1:1", "2:2", "3:4", "3:3", "18:18" ],
            [ "CBP", "Const", "25.02470646", "-111.6749333", "1:2", "1:1", "1:1", "2:2", "2:2", "7:8", "5:5", "5:5" ],
            [ "CBP", "Const", "25.02478998", "-111.6749614", "2:2", "2:2", "2:2", "1:1", "2:2", "3:3", "3:3", "18:18" ],
            [ "CBP", "Const", "25.02473368", "-111.674933", "2:2", "2:2", "2:2", "1:1", "2:2", "3:4", "3:3", "18:18" ],
            [ "CBP", "Const", "25.02474991", "-111.6749708", "1:2", "1:4", "1:1", "1:2", "1:2", "8:8", "5:5", "5:5" ],
            [ "CBP", "77", "24.87615974", "-110.6917163", "1:2", "3:4", "1:1", "1:1", "2:2", "7:7", "5:5", "6:6" ],
            [ "CBP", "77", "24.87617798", "-110.6916775", "1:1", "3:3", "1:1", "2:2", "2:2", "7:7", "5:5", "5:6" ],
            [ "CBP", "77", "24.87616174", "-110.6917494", "1:1", "3:3", "1:1", "1:1", "2:2", "7:7", "5:5", "6:6" ],
            [ "CBP", "77", "24.87619792", "-110.6917153", "2:2", "2:2", "1:1", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "CBP", "77", "24.87617914", "-110.6916993", "1:2", "3:3", "1:1", "1:2", "2:2", "7:8", "5:5", "5:6" ],
            [ "CBP", "77", "24.87611207", "-110.6917448", "1:2", "3:3", "1:1", "1:1", "2:2", "7:7", "5:5", "6:6" ],
            [ "CBP", "77", "24.87612489", "-110.6917408", "2:2", "3:3", "1:1", "2:2", "2:2", "7:8", "5:5", "5:6" ],
            [ "CBP", "77", "24.87613791", "-110.691675", "1:1", "3:3", "1:1", "1:1", "2:2", "7:8", "5:5", "6:7" ],
            [ "CBP", "77", "24.87619399", "-110.6916964", "1:1", "3:3", "1:1", "1:1", "2:2", "7:7", "5:5", "6:6" ],
            [ "CBP", "77", "24.87618744", "-110.6917373", "1:2", "3:3", "1:1", "1:1", "2:2", "9:9", "5:5", "5:6" ],
            [ "CBP", "164", "24.74643194", "-111.5440432", "1:1", "1:2", "1:2", "1:1", "2:2", "3:4", "3:3", "18:18" ],
            [ "CBP", "164", "24.74650135", "-111.5440588", "1:2", "1:4", "1:1", "2:2", "2:2", "8:8", "5:5", "5:6" ],
            [ "CBP", "164", "24.74649205", "-111.544096", "2:2", "2:2", "2:2", "1:1", "2:2", "3:5", "3:3", "18:18" ],
            [ "CBP", "164", "24.74649115", "-111.5440246", "2:2", "1:1", "1:1", "1:2", "1:1", "8:8", "5:5", "5:5" ],
            [ "CBP", "164", "24.74648358", "-111.5440148", "2:2", "1:4", "1:1", "1:1", "1:2", "7:8", "5:5", "5:5" ],
            [ "CBP", "164", "24.7464233", "-111.5440482", "2:2", "1:1", "1:1", "2:2", "1:1", "7:8", "5:5", "5:5" ],
            [ "CBP", "164", "24.74645234", "-111.544042", "2:2", "4:4", "1:1", "1:2", "1:2", "8:8", "5:5", "5:6" ],
            [ "CBP", "164", "24.74647231", "-111.5440895", "1:2", "1:3", "1:1", "2:2", "1:2", "8:8", "5:5", "5:5" ],
            [ "CBP", "164", "24.74650531", "-111.5440443", "1:1", "1:3", "1:1", "1:2", "2:2", "8:8", "5:5", "5:5" ],
            [ "CBP", "164", "24.74646603", "-111.544067", "1:2", "4:4", "1:1", "2:2", "1:2", "8:8", "5:5", "5:5" ],
            [ "CBP", "75", "24.58849289", "-110.7459391", "2:2", "2:2", "1:1", "1:1", "2:2", "5:5", "3:3", "18:19" ],
            [ "CBP", "75", "24.58848366", "-110.7459393", "1:2", "", "1:1", "2:2", "", "", "3:3", "18:18" ],
            [ "CBP", "75", "24.58845039", "-110.7459392", "2:2", "2:2", "1:2", "1:2", "", "", "2:2", "18:18" ],
            [ "CBP", "75", "24.58845243", "-110.7458949", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "CBP", "75", "24.58846632", "-110.7459702", "2:2", "2:2", "1:2", "1:1", "2:2", "5:5", "3:3", "17:18" ],
            [ "CBP", "75", "24.58847555", "-110.7459676", "2:2", "2:2", "1:2", "1:1", "2:2", "5:5", "3:3", "17:17" ],
            [ "CBP", "75", "24.58843449", "-110.7458913", "1:2", "2:2", "1:1", "1:2", "", "", "3:3", "17:18" ],
            [ "CBP", "75", "24.58843511", "-110.745971", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:3", "17:17" ],
            [ "CBP", "75", "24.58844136", "-110.7458908", "2:2", "2:2", "1:2", "1:1", "2:2", "5:5", "3:3", "18:18" ],
            [ "CBP", "75", "24.58851708", "-110.7459542", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "8:8", "10:10" ],
            [ "CBP", "75", "24.58846651", "-110.7459692", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "CBP", "163", "24.21150106", "-110.9509393", "2:2", "2:2", "2:2", "1:1", "2:2", "3:5", "3:3", "18:18" ],
            [ "CBP", "163", "24.21151404", "-110.9509948", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "8:8", "10:11" ],
            [ "CBP", "163", "24.21153809", "-110.95095", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "8:8", "11:11" ],
            [ "CBP", "163", "24.21153409", "-110.9509489", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "8:8", "11:11" ],
            [ "CBP", "163", "24.21157076", "-110.9509833", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "8:8", "11:11" ],
            [ "CBP", "163", "24.21155911", "-110.9509271", "1:2", "2:2", "2:2", "1:1", "2:2", "3:5", "3:3", "18:18" ],
            [ "CBP", "163", "24.21159033", "-110.9509814", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "8:8", "11:11" ],
            [ "CBP", "163", "24.21154609", "-110.9509543", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "8:8", "10:11" ],
            [ "CBP", "163", "24.211506", "-110.9509369", "1:2", "2:2", "2:2", "1:1", "2:2", "3:3", "3:3", "18:18" ],
            [ "CBP", "163", "24.2115588", "-110.9509794", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "8:8", "11:11" ],
            [ "SBP", "ESan", "24.4588066", "-110.3685195", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "5:5", "11:11" ],
            [ "SBP", "ESan", "24.45886953", "-110.3684883", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "ESan", "24.45883119", "-110.36847", "2:2", "2:2", "2:2", "1:1", "2:2", "5:5", "3:3", "18:18" ],
            [ "SBP", "ESan", "24.45887404", "-110.3684755", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "8:8", "10:11" ],
            [ "SBP", "ESan", "24.45883266", "-110.3685238", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "ESan", "24.45886376", "-110.3685269", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "ESan", "24.45883912", "-110.3684839", "2:2", "1:2", "1:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "ESan", "24.45879155", "-110.3684792", "2:2", "1:2", "1:2", "1:1", "2:2", "4:4", "3:3", "17:17" ],
            [ "SBP", "153", "24.13390797", "-110.4622808", "2:2", "1:3", "1:1", "2:2", "1:1", "7:8", "5:5", "7:7" ],
            [ "SBP", "153", "24.13391097", "-110.4623547", "2:2", "3:3", "1:1", "2:2", "2:2", "7:7", "5:5", "5:5" ],
            [ "SBP", "153", "24.13395415", "-110.462317", "2:2", "1:3", "1:1", "2:2", "2:2", "7:9", "5:5", "5:5" ],
            [ "SBP", "153", "24.13389891", "-110.4622996", "1:2", "1:3", "1:1", "2:2", "2:2", "7:7", "5:5", "5:5" ],
            [ "SBP", "153", "24.13398905", "-110.462261", "2:2", "3:3", "1:1", "2:2", "2:2", "7:7", "5:5", "5:5" ],
            [ "SBP", "153", "24.13397852", "-110.4622999", "1:2", "1:3", "1:1", "2:2", "2:2", "7:7", "5:5", "5:7" ],
            [ "SBP", "153", "24.13397333", "-110.4623126", "2:2", "1:3", "1:1", "2:2", "2:2", "8:8", "5:5", "5:5" ],
            [ "SBP", "153", "24.13391952", "-110.4622843", "2:2", "1:3", "1:1", "2:2", "2:2", "8:8", "5:5", "5:5" ],
            [ "SBP", "153", "24.13395147", "-110.4623353", "2:2", "1:3", "1:1", "2:2", "2:2", "7:8", "5:5", "5:8" ],
            [ "SBP", "153", "24.13393635", "-110.4622942", "1:2", "1:3", "1:1", "2:2", "2:2", "7:8", "5:5", "5:6" ],
            [ "SBP", "48", "24.21442897", "-110.2725147", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "48", "24.21441942", "-110.272438", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "1:1", "17:17" ],
            [ "SBP", "48", "24.2144355", "-110.272437", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "48", "24.21445045", "-110.2724502", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "48", "24.21442502", "-110.2725001", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "48", "24.21448872", "-110.2724614", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "48", "24.21442416", "-110.2724983", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "17:18" ],
            [ "SBP", "48", "24.21449203", "-110.2724931", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "17:17" ],
            [ "SBP", "48", "24.21450416", "-110.2724964", "2:2", "2:2", "2:2", "1:1", "2:2", "5:5", "3:3", "18:18" ],
            [ "SBP", "48", "24.21441186", "-110.2724326", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "156", "24.04386225", "-109.9889078", "2:2", "2:2", "2:2", "1:1", "2:2", "5:5", "3:3", "18:18" ],
            [ "SBP", "156", "24.04384139", "-109.9889727", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:3", "17:17" ],
            [ "SBP", "156", "24.04387222", "-109.9889576", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:6", "18:18" ],
            [ "SBP", "156", "24.04384295", "-109.9889336", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "156", "24.0438603", "-109.988944", "2:2", "1:1", "2:2", "1:1", "2:2", "4:4", "3:3", "16:17" ],
            [ "SBP", "156", "24.04384514", "-109.9889426", "2:2", "2:2", "2:2", "1:1", "2:2", "5:5", "3:3", "17:18" ],
            [ "SBP", "157", "24.01956241", "-110.0959964", "2:2", "2:2", "2:2", "1:1", "2:2", "5:5", "3:3", "17:18" ],
            [ "SBP", "157", "24.01951523", "-110.0959962", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:3", "17:18" ],
            [ "SBP", "157", "24.01954827", "-110.0959866", "2:2", "1:3", "1:1", "1:1", "2:2", "6:6", "5:5", "11:11" ],
            [ "SBP", "157", "24.01957613", "-110.0959616", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:6", "17:17" ],
            [ "SBP", "157", "24.01959315", "-110.0959276", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:6", "18:18" ],
            [ "SBP", "157", "24.0195667", "-110.0959984", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "5:7", "11:11" ],
            [ "SBP", "157", "24.01957043", "-110.0959064", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "157", "24.01956639", "-110.0959728", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "157", "24.01957993", "-110.09597", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "17:18" ],
            [ "SBP", "157", "24.01957822", "-110.0959324", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "17:17" ],
            [ "SBP", "73", "24.00795513", "-109.8506381", "2:2", "3:3", "1:1", "1:1", "2:2", "6:7", "5:5", "11:11" ],
            [ "SBP", "73", "24.00794527", "-109.850692", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "73", "24.00791447", "-109.8506472", "2:2", "2:2", "1:2", "1:1", "2:2", "5:5", "3:3", "18:19" ],
            [ "SBP", "73", "24.00790477", "-109.8506127", "2:2", "2:2", "1:2", "1:1", "2:2", "5:5", "3:3", "17:17" ],
            [ "SBP", "73", "24.00798085", "-109.8506102", "2:2", "2:2", "1:2", "1:1", "", "5:5", "3:3", "18:18" ],
            [ "SBP", "73", "24.0079471", "-109.8506568", "2:2", "3:3", "1:1", "1:1", "2:2", "6:7", "5:5", "10:11" ],
            [ "SBP", "73", "24.00795226", "-109.8506741", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "73", "24.00796576", "-109.8506782", "2:2", "2:2", "1:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "73", "24.00797353", "-109.850666", "2:2", "2:2", "1:2", "1:1", "2:2", "5:5", "3:3", "18:18" ],
            [ "SBP", "73", "24.00793611", "-109.8506713", "2:2", "2:2", "1:2", "1:1", "2:2", "5:5", "3:3", "18:18" ],
            [ "SBP", "Aqu", "23.28554374", "-110.1042229", "1:2", "2:2", "1:2", "1:1", "2:2", "5:5", "3:3", "18:18" ],
            [ "SBP", "Aqu", "23.285536", "-110.1042634", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "5:5", "11:11" ],
            [ "SBP", "Aqu", "23.2855992", "-110.1042591", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "5:5", "10:10" ],
            [ "SBP", "Aqu", "23.28551932", "-110.1042321", "1:2", "2:2", "1:1", "1:1", "2:2", "4:4", "3:3", "18:19" ],
            [ "SBP", "Aqu", "23.28551326", "-110.1042894", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "Aqu", "23.28555557", "-110.1042226", "1:2", "", "", "1:2", "", "", "2:2", "" ],
            [ "SBP", "Aqu", "23.28552059", "-110.1042079", "2:2", "2:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "Aqu", "23.28554304", "-110.1041918", "2:2", "3:3", "1:1", "1:1", "2:2", "5:6", "5:5", "11:11" ],
            [ "SBP", "Mat", "23.08988554", "-110.1090975", "2:2", "1:1", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "Mat", "23.08990371", "-110.1090747", "2:2", "1:2", "2:2", "1:1", "2:2", "4:4", "3:3", "18:18" ],
            [ "SBP", "Mat", "23.08993683", "-110.1090878", "2:2", "1:1", "2:2", "1:1", "2:2", "5:5", "3:3", "17:18" ],
            [ "SBP", "Mat", "23.08986293", "-110.1090666", "2:2", "1:1", "2:2", "1:1", "2:2", "5:5", "3:3", "18:18" ],
            [ "SBP", "Mat", "23.08984946", "-110.1090327", "1:2", "", "", "1:2", "", "", "5:5", "" ],
            [ "SBP", "98", "23.0757895", "-109.6486119", "2:2", "3:3", "1:1", "1:1", "2:2", "6:6", "5:5", "10:11" ],
            [ "SBP", "98", "23.07574123", "-109.6486615", "2:2", "1:1", "2:2", "1:1", "2:2", "5:5", "3:3", "18:18" ],
            [ "SBP", "98", "23.07576346", "-109.6486331", "2:2", "1:1", "2:2", "1:1", "2:2", "5:5", "3:3", "18:18" ],
            [ "SBP", "98", "23.07575572", "-109.6486634", "2:2", "1:1", "2:2", "1:1", "2:2", "5:5", "3:3", "18:18" ],
            [ "SON", "101", "27.90511059", "-110.5743491", "1:2", "", "1:1", "", "", "", "2:2", "" ],
            [ "SON", "101", "27.90512369", "-110.5743223", "2:2", "1:1", "1:1", "1:1", "", "", "2:2", "13:13" ],
            [ "SON", "101", "27.90518842", "-110.5743386", "1:2", "", "1:1", "1:2", "", "", "9:9", "" ],
            [ "SON", "101", "27.90515653", "-110.5742607", "2:2", "1:1", "3:3", "1:2", "1:1", "11:11", "2:2", "13:14" ],
            [ "SON", "101", "27.90510994", "-110.5742844", "1:2", "1:1", "1:1", "1:2", "", "8:8", "4:4", "12:12" ],
            [ "SON", "101", "27.90515172", "-110.5743432", "1:2", "1:1", "3:3", "1:2", "", "", "2:2", "12:12" ],
            [ "SON", "101", "27.90517097", "-110.5743381", "2:2", "1:1", "1:1", "1:2", "", "", "2:5", "2:13" ],
            [ "SON", "101", "27.90515312", "-110.5743516", "2:2", "1:1", "3:3", "1:1", "", "", "2:2", "2:12" ],
            [ "SON", "101", "27.90511032", "-110.5743536", "1:2", "", "1:1", "", "", "", "2:9", "" ],
            [ "SON", "101", "27.9051764", "-110.5743076", "2:2", "1:1", "1:3", "1:1", "", "", "2:9", "11:12" ],
            [ "SON", "32", "26.63784934", "-109.3269474", "1:2", "1:3", "1:1", "1:2", "2:2", "", "2:2", "12:13" ],
            [ "SON", "32", "26.63786997", "-109.3269841", "2:2", "1:1", "3:3", "1:1", "2:2", "11:11", "2:4", "13:13" ],
            [ "SON", "32", "26.63787623", "-109.3269148", "2:2", "1:1", "3:4", "1:1", "2:2", "11:11", "2:2", "3:12" ],
            [ "SON", "32", "26.63786871", "-109.3269177", "1:2", "1:1", "3:3", "1:1", "2:2", "11:11", "2:2", "3:13" ],
            [ "SON", "32", "26.63786172", "-109.326919", "2:2", "1:1", "3:3", "1:1", "2:2", "11:11", "2:2", "12:12" ],
            [ "SON", "32", "26.63791344", "-109.3269034", "2:2", "1:1", "3:3", "1:1", "2:2", "11:11", "2:2", "12:13" ],
            [ "SON", "32", "26.63791388", "-109.3269985", "1:2", "1:1", "3:3", "1:1", "2:2", "11:11", "2:2", "2:14" ],
            [ "SON", "32", "26.6378652", "-109.3269949", "2:2", "1:1", "3:3", "1:1", "2:2", "12:12", "2:3", "12:12" ],
            [ "SON", "32", "26.63790309", "-109.326994", "2:2", "1:1", "3:3", "1:1", "2:2", "12:12", "2:2", "13:13" ],
            [ "SON", "32", "26.6378669", "-109.326923", "2:2", "1:1", "3:3", "1:1", "2:2", "11:11", "2:2", "2:10" ],
            [ "SON", "32", "26.63786131", "-109.3269228", "1:1", "1:1", "3:4", "1:1", "2:2", "12:12", "2:2", "11:13" ],
            [ "SON", "32", "26.63788188", "-109.3269664", "1:2", "1:1", "3:4", "1:1", "2:2", "8:12", "2:4", "1:12" ],
            [ "SON", "32", "26.63788558", "-109.3269886", "1:2", "1:1", "4:4", "1:1", "2:2", "11:11", "2:2", "3:13" ],
            [ "SON", "32", "26.63792443", "-109.3269818", "2:2", "1:1", "3:4", "1:1", "2:2", "10:11", "2:2", "11:11" ],
            [ "SON", "32", "26.63784271", "-109.3269899", "1:2", "1:1", "3:3", "1:1", "2:2", "12:12", "2:2", "10:13" ],
            [ "SON", "32", "26.63784064", "-109.3269193", "2:2", "1:1", "3:3", "1:1", "2:2", "12:12", "2:2", "2:10" ],
            [ "SON", "32", "26.63787395", "-109.3269191", "1:2", "1:1", "3:4", "1:1", "2:2", "8:11", "2:2", "2:14" ],
            [ "SON", "32", "26.63787087", "-109.3269919", "2:2", "1:1", "3:3", "1:1", "2:2", "11:11", "2:2", "3:13" ],
            [ "SON", "32", "26.63786352", "-109.3269537", "2:2", "1:1", "3:4", "1:1", "2:2", "11:11", "2:2", "11:12" ],
            [ "SON", "102", "26.38015336", "-109.1262736", "2:2", "", "1:3", "1:2", "", "", "2:9", "9:9" ],
            [ "SON", "102", "26.38019832", "-109.1263125", "1:2", "", "1:3", "1:2", "", "", "2:9", "3:12" ],
            [ "SON", "102", "26.38014714", "-109.1262703", "1:2", "1:1", "3:3", "1:2", "", "", "2:2", "3:12" ],
            [ "SON", "102", "26.38022669", "-109.126323", "1:2", "", "", "1:2", "", "", "2:2", "2:5" ],
            [ "SON", "102", "26.38014538", "-109.1262792", "1:2", "1:1", "3:3", "1:1", "", "", "2:2", "11:12" ],
            [ "SON", "102", "26.38019723", "-109.1262358", "1:2", "", "3:3", "1:2", "", "11:11", "2:2", "11:13" ],
            [ "SON", "102", "26.38021682", "-109.1262463", "2:2", "1:1", "1:1", "1:1", "", "", "2:2", "12:12" ],
            [ "SON", "102", "26.38023371", "-109.1262476", "1:2", "1:1", "3:3", "1:2", "", "", "2:2", "12:12" ],
            [ "SON", "102", "26.38020234", "-109.1262803", "2:2", "1:1", "3:3", "1:2", "", "", "2:2", "3:13"]
        ]
        let header = ["Region", "Pop", "Latitude", "Longitude", "LTRS", "WNT", "EN", "EF", "ZMP", "AML", "ATPS", "MP20" ]
        let K = header.count
        let strataKeys = ["Region","Pop"]
        
        for i in 0 ..< raw.count {
            let ind = Individual()
            let strata = [ raw[i][0], raw[i][1] ]
            if let lat = Double( raw[i][2] ),
               let lon = Double( raw[i][3] )  {
                ind.location = CLLocationCoordinate2D(latitude: lat, longitude: lon)
            }
            
            for j in 4 ..< K {
                ind.loci[ header[j] ] = Locus(raw: raw[i][j] )
            }
            stratum.addIndividual(individual: ind , strata: strata, levels: strataKeys )
        }
        
        
        
        return stratum
    }
    
}
